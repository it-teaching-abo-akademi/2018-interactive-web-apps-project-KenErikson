(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{16:function(t,e,a){t.exports=a(45)},22:function(t,e,a){},24:function(t,e,a){},45:function(t,e,a){"use strict";a.r(e);var n=a(0),o=a.n(n),r=a(15),s=a.n(r),i=(a(22),a(2)),l=a(3),c=a(5),u=a(4),d=a(6),h=(a(24),function(t){function e(t){var a;return Object(i.a)(this,e),(a=Object(c.a)(this,Object(u.a)(e).call(this,t))).state={inputValue:t.title},a}return Object(d.a)(e,t),Object(l.a)(e,[{key:"handleInput",value:function(t){t.preventDefault();var e=this.state.inputValue;this.props.handleTitle(e)}},{key:"updateInputValue",value:function(t){t.preventDefault(),this.setState({inputValue:t.target.value})}},{key:"render",value:function(){var t=this,e=this.state.inputValue;return o.a.createElement("form",{className:"Add-Stock-Form",ref:"form",onSubmit:function(e){return t.handleInput(e)}},o.a.createElement("input",{className:"Portfolio-Title",type:"text",value:e,onChange:function(e){return t.updateInputValue(e)}}),o.a.createElement("button",{type:"submit"},"Save"))}}]),e}(n.Component)),f=function(t){function e(){return Object(i.a)(this,e),Object(c.a)(this,Object(u.a)(e).apply(this,arguments))}return Object(d.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){var t=this.props.title;return o.a.createElement("span",{className:"Portfolio-Title"},t)}}]),e}(n.Component),m=function(t){function e(t){var a;return Object(i.a)(this,e),(a=Object(c.a)(this,Object(u.a)(e).call(this,t))).DECIMALS_UNIT=3,a.DECIMALS_TOTAL=2,a}return Object(d.a)(e,t),Object(l.a)(e,[{key:"toggleSelected",value:function(){this.props.toggleSelectedStock(this.props.name)}},{key:"render",value:function(){var t=this,e=Math.pow(10,this.DECIMALS_UNIT),a=Math.pow(10,this.DECIMALS_TOTAL),n=1;return this.props.isShowingEruos()&&(n=this.props.getExchangeRate()),o.a.createElement("tr",null,o.a.createElement("td",{className:"large-col"},this.props.name),o.a.createElement("td",{className:"large-col"},parseInt(this.props.price*n*e)/e),o.a.createElement("td",{className:"small-col"},this.props.quantity),o.a.createElement("td",{className:"large-col"},parseInt(this.props.price*n*this.props.quantity*a)/a),o.a.createElement("td",{className:"small-col"},o.a.createElement("input",{type:"checkbox",name:"selected",value:"selected",onChange:function(){return t.toggleSelected()},checked:this.props.selected})))}}]),e}(n.Component),E=a(7),v=a.n(E),p=function(t){function e(t){var a;Object(i.a)(this,e),a=Object(c.a)(this,Object(u.a)(e).call(this,t));var n=t.state;return a.state=null!=n?n:{userIsEditing:!1,userIsAddingStock:!1,showingEuro:!1,errorText:"",addStockQuantity:1,addStockName:"",title:"Portfolio "+t.id,stocks:[]},a}return Object(d.a)(e,t),Object(l.a)(e,[{key:"setAndSaveState",value:function(t){var e=this.state;for(var a in e)for(var n in t)a===n&&(e[n]=t[n]);this.setState(e),this.props.savePortfolio(e)}},{key:"getExchangeRate",value:function(){return this.props.EXCHANGE_RATE_USD_TO_EUR}},{key:"isShowingEruos",value:function(){return!!this.state.showingEuro}},{key:"toggleEditing",value:function(){this.resetErrorText();var t=!this.state.userIsEditing;this.setAndSaveState({userIsEditing:t})}},{key:"toggleAddingStock",value:function(){this.resetErrorText();var t=!this.state.userIsAddingStock;this.setAndSaveState({userIsAddingStock:t})}},{key:"updateTitle",value:function(t){this.resetErrorText(),this.setAndSaveState({title:t,userIsEditing:!1})}},{key:"fetchStockData",value:function(t){var e="https://www.alphavantage.co/query?function=BATCH_STOCK_QUOTES&symbols="+t+"&apikey="+this.props.API_KEY;return console.log(e),v.a.get(e)}},{key:"addStock",value:function(t,e){var a=this,n=parseInt(e);if(""!==t&&n>0)if(this.getPending)this.setErrorText("Adding stock too fast, take a deep breath.");else{this.getPending=!0;for(var o=this.state.stocks,r=!1,s=-1,i=0;i<o.length;i++)if(o[i].name===t){r=!0,s=i;break}if(r)this.setStock(s,n,-1),this.getPending=!1;else if(o.length<50)this.fetchStockData(t).then(function(e){var r=e.data["Stock Quotes"];if(null==r)a.setErrorText("Error getting data for '"+t+"' from API, probably overused API-key");else{for(var s=[],i=0;i<r.length;i++){var l=r[0],c=l["1. symbol"],u=l["2. price"];s.push({name:c,price:u})}if(1===s.length){var d=!1,h=-1;for(i=0;i<o.length;i++)if(o[i].key===t){d=!0,h=i;break}if(d){for(i=0;i<o.length;i++)if(o[i].name===t){d=!0,h=i;break}d&&a.setStock(h,n,-1)}else o.push({name:t,quantity:n,price:s[0].price,selected:!1,index:o.length}),a.setAndSaveState({stocks:o}),a.updateStockPrices()}else a.setErrorText("Can't find stock for symbol '"+t+"'")}a.getPending=!1}).catch(function(t){console.log(t),a.setErrorText("Error during updating stocks: "+t),a.getPending=!1});else this.setErrorText("Can't add more unique stock names.")}else""===t?this.setErrorText("Can't add stock with empty name"):this.setErrorText("Can't add stock with quantity<1")}},{key:"handleChangeStockQuantity",value:function(t){var e=t.target.validity.valid?t.target.value:this.state.addStockQuantity;this.setAndSaveState({addStockQuantity:e})}},{key:"handleChangeStockName",value:function(t){var e=t.target.validity.valid?t.target.value:this.state.addStockName;this.setAndSaveState({addStockName:e})}},{key:"handleAddStockSubmit",value:function(t){this.resetErrorText(),t.preventDefault();var e=t.target.name.value,a=t.target.quantity.value;this.addStock(e,a)}},{key:"getAddStockFields",value:function(){var t=this;return o.a.createElement("div",{className:"row"},o.a.createElement("form",{className:"Add-Stock-Form",ref:"form",onSubmit:function(e){return t.handleAddStockSubmit(e)}},o.a.createElement("label",{htmlFor:"name"},"Stock Name:"),o.a.createElement("input",{id:"name",value:this.state.addStockName,type:"text",pattern:"[A-Z-.]{0,5}",onChange:function(e){return t.handleChangeStockName(e)}}),o.a.createElement("label",{htmlFor:"quantity"},"Quantity:"),o.a.createElement("input",{id:"quantity",type:"number",step:"1",min:"1",max:"1000000",onChange:function(e){return t.handleChangeStockQuantity(e)},value:this.state.addStockQuantity}),o.a.createElement("button",{type:"submit"},"Add stock")),o.a.createElement("button",{onClick:function(){return t.toggleAddingStock()}},"Cancel"))}},{key:"resetErrorText",value:function(){this.setAndSaveState({errorText:""})}},{key:"setErrorText",value:function(t){this.setAndSaveState({errorText:t})}},{key:"updateStockPrices",value:function(){for(var t=this,e=this.state.stocks,a="",n=0;n<e.length;n++)n>0&&(a+=","),a+=e[n].name;""!==a&&this.fetchStockData(a).then(function(e){var a=e.data["Stock Quotes"];if(null==a)t.setErrorText("Error updating all stocks from API, probably overused API-key");else for(var n=0;n<a.length;n++){var o=a[n],r=o["1. symbol"],s=o["2. price"];t.setUnitValue(r,s)}}).catch(function(e){console.log(e),t.setErrorText("Error during updating stocks: "+e)})}},{key:"toggleShowingEuro",value:function(){var t=!this.state.showingEuro;this.setAndSaveState({showingEuro:t});for(var e=this.state.stocks,a=0;a<e.length;a++)this.setStock(a,0,-1)}},{key:"setUnitValue",value:function(t,e){for(var a=this.state.stocks,n=!1,o=0;o<a.length;o++)if(a[o].name===t){this.setStock(o,0,e),n=!0;break}n||this.setErrorText("Couldn't find '"+t+"' when updating prices.")}},{key:"setStock",value:function(t,e,a){var n=parseInt(e),o=this.state.stocks,r=o[t],s=r.name,i=parseInt(r.quantity),l=r.price;-1===a&&(a=l);var c={name:s,quantity:i+n,price:a,selected:!1,index:t};o.splice(t,1,c),this.setAndSaveState({stocks:o})}},{key:"calculateTotalValue",value:function(){for(var t=this.state.stocks,e=0,a=0;a<t.length;a++)e+=parseFloat(t[a].price*t[a].quantity);return this.state.showingEuro&&(e*=this.props.EXCHANGE_RATE_USD_TO_EUR),parseInt(100*e)/100}},{key:"toggleSelectedStock",value:function(t){for(var e=-1,a=!1,n=this.state.stocks,o=0;o<n.length;o++){if(n[o].name===t){a=!0,e=o;break}}if(a){var r=n[e];r.selected=!r.selected,n.splice(e,1,r),this.setAndSaveState({stocks:n})}else this.setErrorText("Found no stock with name:"+t)}},{key:"removeSelected",value:function(){for(var t=this.state.stocks,e=t.length-1;e>=0;e--){t[e].selected&&t.splice(e,1)}this.setAndSaveState({stocks:t})}},{key:"render",value:function(){for(var t,e,a,n=this,r=this.state.userIsEditing,s=this.state.userIsAddingStock,i=this.state.stocks,l=!1,c=0;c<i.length;c++)if(i[c].selected){l=!0;break}a=l?o.a.createElement("button",{onClick:function(){return n.removeSelected()}},"Remove selected"):o.a.createElement("button",{className:"Disabled-Button",disabled:!0},"Remove selected");var u=[];for(c=0;c<i.length;c++){var d=i[c].name,E=i[c].price,v=i[c].quantity,p=i[c].selected;u.push(o.a.createElement(m,{key:d,name:d,price:E,quantity:v,selected:p,index:c,getExchangeRate:function(){return n.getExchangeRate()},isShowingEruos:function(){return n.isShowingEruos()},toggleSelectedStock:function(t){return n.toggleSelectedStock(t)}}))}var g=this.state.errorText,k=this.state.showingEuro;r?(e="Cancel",t=o.a.createElement(h,{className:"Portfolio-Title",title:this.state.title,handleTitle:function(t){return n.updateTitle(t)}})):(e="Edit",t=o.a.createElement(f,{className:"Portfolio-Title",title:this.state.title}));var S,y=o.a.createElement("button",{onClick:function(){return n.toggleAddingStock()}},"Add Stocks");s&&(S=this.getAddStockFields(),y=o.a.createElement("button",{className:"Disabled-Button",disabled:!0},"Add Stocks"));var b="$",T="\u20ac";k&&(b="\u20ac",T="$");var A=this.calculateTotalValue(),x="Portfolio-Board-Header-Wrapper";return u.length>4&&(x+=" Portfolio-Board-Scrollbar"),o.a.createElement("div",{className:"App-Portfolio"},o.a.createElement("div",{className:"row"},t,o.a.createElement("button",{onClick:function(){return n.toggleEditing()}},e),o.a.createElement("button",{className:"Exit-Button",onClick:function(){return n.props.onClick(n.props.id)}},"X")),o.a.createElement("div",{className:"row"},o.a.createElement("span",{className:"bold"},"Showing "),o.a.createElement("span",{className:"bold large"},b),o.a.createElement("button",{onClick:function(){return n.toggleShowingEuro()}},"Show in ",T),o.a.createElement("span",{className:"Error-Text"},g)),o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:x},o.a.createElement("table",{className:"Portfolio-Board"},o.a.createElement("tbody",null,o.a.createElement("tr",null,o.a.createElement("th",{className:"large-col"},"Name"),o.a.createElement("th",{className:"large-col"},"Unit value"),o.a.createElement("th",{className:"small-col"},"Quantity"),o.a.createElement("th",{className:"large-col"},"Total value"),o.a.createElement("th",{className:"small-col"},"Select"))))),o.a.createElement("div",{className:"Portfolio-Board-Wrapper"},o.a.createElement("table",{className:"Portfolio-Board"},o.a.createElement("tbody",null,u)))),o.a.createElement("div",{className:"row"},"Total value: ",A,b),S,o.a.createElement("div",{className:"row"},y,a))}}]),e}(n.Component),g=function(t){function e(t){var a;Object(i.a)(this,e),(a=Object(c.a)(this,Object(u.a)(e).call(this,t))).API_KEY="5V5OEOEN5K98E697";var n=JSON.parse(window.localStorage.getItem("saved_state"));return console.log("Loaded State: "+window.localStorage.getItem("saved_state")),a.state=n||{EXCHANGE_RATE_USD_TO_EUR:0,triedInitExchangeRateLoad:!1,errorText:"",infoText:"",portfolioCount:0,portfolios:[],nextId:0},a}return Object(d.a)(e,t),Object(l.a)(e,[{key:"savePortfolio",value:function(t,e){for(var a=this.state.portfolios,n=0;n<a.length;n++)if(a[n].id===t){var o={id:t,state:e};a.splice(n,1,o)}this.setState({portfolios:a}),this.updateExchangeRate(),this.setInfoText(""),this.setErrorText("")}},{key:"componentDidUpdate",value:function(){var t=this.state;console.log("Saved State:"+JSON.stringify(t)),window.localStorage.setItem("saved_state",JSON.stringify(t))}},{key:"removePortfolio",value:function(t){for(var e=this.state.portfolioCount,a=this.state.portfolios,n=this.state.nextId,o=!1,r=0;r<a.length;r++)if(a[r].id===t){a.splice(r,1),o=!0,e--;break}o||console.log("Nothing Removed"),this.setState({portfolioCount:e,portfolios:a,nextId:n})}},{key:"addPortfolio",value:function(){var t=this.state.portfolioCount,e=this.state.portfolios,a=this.state.nextId;t<10&&(e.push({id:a}),this.setInfoText("Added Portfolio ("+e.length+")"),this.setState({portfolioCount:t+1,portfolios:e,nextId:a+1})),this.updateExchangeRate()}},{key:"updateExchangeRate",value:function(){var t=this;if(0===this.state.EXCHANGE_RATE_USD_TO_EUR){this.state.triedInitExchangeRateLoad||this.setState({triedInitExchangeRateLoad:!0});var e="https://www.alphavantage.co/query?function=CURRENCY_EXCHANGE_RATE&from_currency=USD&to_currency=EUR&apikey="+this.props.API_KEY;v.a.get(e).then(function(e){var a=e.data["Realtime Currency Exchange Rate"];if(null==a)t.setErrorText("Error getting exchange rate data from API, probably overused API-key. Add new Portfolio or stock to retry.");else{var n=a["5. Exchange Rate"];t.setState({EXCHANGE_RATE_USD_TO_EUR:n}),t.setErrorText("")}}).catch(function(e){console.log(e),t.setErrorText("Error during updating exchange rate: "+e)})}}},{key:"setErrorText",value:function(t){this.setState({errorText:t})}},{key:"setInfoText",value:function(t){this.setState({infoText:t})}},{key:"render",value:function(){var t=this;this.state.triedInitExchangeRateLoad||this.updateExchangeRate();var e=this.state.portfolioCount,a=o.a.createElement("button",{id:"addPortfolioButton",onClick:function(){return t.addPortfolio()}},"Add Portfolio");e>9&&(a=o.a.createElement("button",{className:"Disabled-Button",id:"addPortfolioButton",disabled:!0},"Add Portfolio"));for(var n=this.state.portfolios,r=[],s=function(){var e=n[i].id,a=n[i].state;r.push(o.a.createElement(p,{key:e,id:e,API_KEY:t.API_KEY,EXCHANGE_RATE_USD_TO_EUR:t.state.EXCHANGE_RATE_USD_TO_EUR,state:a,onClick:function(){return t.removePortfolio(e)},savePortfolio:function(a){return t.savePortfolio(e,a)}}))},i=0;i<n.length;i++)s();var l=this.state.errorText,c=this.state.infoText;return o.a.createElement("div",{className:"App"},a,o.a.createElement("div",{className:"row Info-Row"},o.a.createElement("p",{className:"Error-Text"},l),o.a.createElement("p",{className:"Info-Text"},c)),o.a.createElement("div",{className:"App-Portfolios"},r))}}]),e}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(o.a.createElement(g,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()})}},[[16,2,1]]]);
//# sourceMappingURL=main.b40de9b5.chunk.js.map